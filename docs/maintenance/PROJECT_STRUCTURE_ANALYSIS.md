# é¡¹ç›®ç»“æ„åˆ†ææŠ¥å‘Š

## ğŸ“Š ç°æœ‰é¡¹ç›®å…³ç³»

### 1. **Trading.Core** - æ ¸å¿ƒé¢†åŸŸé€»è¾‘å±‚
**èŒè´£**ï¼šç­–ç•¥ã€æŒ‡æ ‡è®¡ç®—ã€é£é™©ç®¡ç†
**ä¾èµ–**ï¼šTrading.Data
**å†…å®¹**ï¼š
```
Trading.Core/
â”œâ”€â”€ Strategies/           - äº¤æ˜“ç­–ç•¥ï¼ˆPinBarStrategy, ITradingStrategyï¼‰
â”œâ”€â”€ Indicators/           - æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ï¼ˆIndicatorCalculatorï¼‰
â”œâ”€â”€ RiskManagement/       - é£é™©ç®¡ç†ï¼ˆRiskManager, PositionSizerï¼‰
â””â”€â”€ Trading/              - äº¤æ˜“æ¥å£ï¼ˆIOrderExecutionServiceï¼‰
```

### 2. **Trading.Models** - æ•°æ®æ¨¡å‹ä¸åŸºç¡€è®¾æ–½å±‚
**èŒè´£**ï¼šæ•°æ®æ¨¡å‹ã€é…ç½®ã€Cosmos DBè®¿é—®ã€CSVæ•°æ®åŠ è½½
**ä¾èµ–**ï¼šæ— ï¼ˆåº•å±‚ï¼‰
**å†…å®¹**ï¼š
```
Trading.Models/
â”œâ”€â”€ Models/               - æ•°æ®æ¨¡å‹ï¼ˆCandle, Trade, BacktestResult, StrategyConfigï¼‰
â”œâ”€â”€ Configuration/        - é…ç½®æ¨¡å‹ï¼ˆAppSettings, CosmosDbSettingsï¼‰
â”œâ”€â”€ Interfaces/           - æ¥å£å®šä¹‰ï¼ˆIMarketDataProvider, IRepositoriesï¼‰
â”œâ”€â”€ Providers/            - æ•°æ®æä¾›è€…ï¼ˆCsvDataProviderï¼‰
â”œâ”€â”€ Repositories/         - Cosmos DBä»“å‚¨ï¼ˆCosmosRepositoriesï¼‰
â””â”€â”€ Infrastructure/       - åŸºç¡€è®¾æ–½ï¼ˆCosmosDbContext, JSONè½¬æ¢å™¨ï¼‰
```

### 3. **Trading.Infrastructure** - åŸºç¡€è®¾æ–½æ•°æ®å±‚ï¼ˆå¤–éƒ¨æœåŠ¡é›†æˆï¼‰
**èŒè´£**ï¼šç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆã€å®æ—¶ç›‘æ§æ•°æ®å­˜å‚¨
**ä¾èµ–**ï¼šTrading.Data
**å†…å®¹**ï¼š
```
Trading.Infrastructure/
â”œâ”€â”€ Services/             - å¤–éƒ¨æœåŠ¡ï¼ˆTelegram, Email, Oanda, TradeLockerï¼‰
â”œâ”€â”€ Repositories/         - Azure Table Storageä»“å‚¨ï¼ˆPinBar/EMAç›‘æ§ï¼‰
â”œâ”€â”€ Models/               - ç›‘æ§é…ç½®æ¨¡å‹ï¼ˆPinBarMonitoringConfig, SymbolPriceï¼‰
â””â”€â”€ Configuration/        - å¤–éƒ¨æœåŠ¡é…ç½®
```

---

## ğŸ” å…³ç³»åˆ†æ

### **Trading.Models vs Trading.Infrastructure**

| ç»´åº¦ | Trading.Models | Trading.Infrastructure |
|------|--------------|---------------------|
| **æ•°æ®å­˜å‚¨** | Cosmos DBï¼ˆå†å²å›æµ‹æ•°æ®ï¼‰ | Azure Table Storageï¼ˆå®æ—¶ç›‘æ§æ•°æ®ï¼‰ |
| **èŒè´£** | æ ¸å¿ƒæ•°æ®æ¨¡å‹ã€å›æµ‹æ•°æ®è®¿é—® | å¤–éƒ¨æœåŠ¡é›†æˆã€ç›‘æ§å‘Šè­¦æ•°æ® |
| **ä½¿ç”¨åœºæ™¯** | å›æµ‹ã€ç­–ç•¥åˆ†æ | å®æ—¶ç›‘æ§ã€å‘Šè­¦é€šçŸ¥ |
| **ä¾èµ–æ–¹å‘** | è¢«æ‰€æœ‰é¡¹ç›®ä¾èµ– | ä»…è¢«Service/Webå±‚ä½¿ç”¨ |
| **å‘½åç©ºé—´** | Trading.Data.* | Trading.Infrastructure.* |

### **Trading.Core vs Trading.Infrastructure**

| ç»´åº¦ | Trading.Core | Trading.Infrastructure |
|------|--------------|---------------------|
| **èŒè´£** | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆç­–ç•¥ã€æŒ‡æ ‡ã€é£é™©ç®¡ç†ï¼‰ | åŸºç¡€è®¾æ–½ï¼ˆå¤–éƒ¨æœåŠ¡ã€é€šçŸ¥ï¼‰ |
| **ä¾èµ–** | Trading.Models | Trading.Models |
| **çº¯åº¦** | çº¯ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–å¤–éƒ¨æœåŠ¡ | ä¾èµ–å¤–éƒ¨APIï¼ˆTelegramã€Emailã€Oandaï¼‰ |

---

## âœ… é¡¹ç›®ç»“æ„è¯„ä¼°

### **ä¼˜ç‚¹**
1. âœ… **èŒè´£æ¸…æ™°**ï¼šCoreï¼ˆä¸šåŠ¡ï¼‰ã€Dataï¼ˆæ•°æ®ï¼‰ã€Infrasï¼ˆåŸºç¡€è®¾æ–½ï¼‰åˆ†ç¦»åˆç†
2. âœ… **ä¾èµ–æ–¹å‘æ­£ç¡®**ï¼šåº•å±‚ä¸ä¾èµ–ä¸Šå±‚
   - Trading.Modelsï¼ˆåº•å±‚ï¼‰â† Trading.Core â† Trading.Services
   - Trading.Modelsï¼ˆåº•å±‚ï¼‰â† Trading.Infrastructure â† Trading.Services
3. âœ… **å‘½åä¸€è‡´**ï¼šInfras.* ç³»åˆ—ç»Ÿä¸€ï¼ˆä»AlertSystemé‡æ„è€Œæ¥ï¼‰
4. âœ… **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªé¡¹ç›®èŒè´£æ˜ç¡®

### **éœ€è¦ä¼˜åŒ–çš„åœ°æ–¹**

#### âš ï¸ 1. Trading.Models èŒè´£è¿‡é‡
**é—®é¢˜**ï¼šTrading.Models åŒæ—¶åŒ…å«ï¼š
- æ•°æ®æ¨¡å‹ï¼ˆModels/ï¼‰
- Cosmos DBåŸºç¡€è®¾æ–½ï¼ˆInfrastructure/CosmosDbContextï¼‰
- CSVæ•°æ®æä¾›è€…ï¼ˆProviders/CsvDataProviderï¼‰
- é…ç½®æ¨¡å‹ï¼ˆConfiguration/ï¼‰

**å»ºè®®**ï¼š
```
é€‰é¡¹Aï¼šæ‹†åˆ†æ•°æ®è®¿é—®å±‚ï¼ˆæ¨èï¼‰
â”œâ”€â”€ Trading.Models          - çº¯æ•°æ®æ¨¡å‹ï¼ˆCandle, Trade, StrategyConfigï¼‰
â”œâ”€â”€ Trading.Models            - æ•°æ®è®¿é—®æŠ½è±¡ï¼ˆInterfaces, Configurationï¼‰
â””â”€â”€ Trading.Data.Cosmos     - Cosmos DBå®ç°ï¼ˆRepository, CosmosDbContextï¼‰

é€‰é¡¹Bï¼šä¿æŒç°çŠ¶ï¼ˆå¦‚æœé¡¹ç›®ä¸å¤§ï¼‰
ç»´æŒTrading.Modelsï¼Œä½†æ˜ç¡®èŒè´£è¾¹ç•Œ
```

#### âš ï¸ 2. Trading.Infrastructure å‘½åå¯èƒ½å¼•èµ·æ··æ·†
**é—®é¢˜**ï¼š
- `Trading.Models` - æ ¸å¿ƒæ•°æ®å±‚
- `Trading.Infrastructure` - åŸºç¡€è®¾æ–½æ•°æ®å±‚

ä¸¤è€…éƒ½æœ‰"Data"ï¼Œä½†èŒè´£å®Œå…¨ä¸åŒã€‚æ–°å¼€å‘è€…å¯èƒ½å›°æƒ‘ã€‚

**å»ºè®®**ï¼š
```
é€‰é¡¹Aï¼šé‡å‘½åä¸º Trading.Infras.Integrationï¼ˆæ¨èï¼‰
æ›´æ¸…æ™°è¡¨è¾¾"å¤–éƒ¨æœåŠ¡é›†æˆ"çš„èŒè´£

é€‰é¡¹Bï¼šé‡å‘½åä¸º Trading.Infras.Monitoring
èšç„¦"ç›‘æ§å‘Šè­¦"çš„æ ¸å¿ƒåœºæ™¯

é€‰é¡¹Cï¼šä¿æŒç°çŠ¶
å¦‚æœå›¢é˜Ÿå·²ç†Ÿæ‚‰ï¼Œæ”¹åæˆæœ¬å¯èƒ½å¤§äºæ”¶ç›Š
```

#### âš ï¸ 3. Trading.Infrastructure å¯èƒ½éœ€è¦æ‹†åˆ†
**å½“å‰å†…å®¹**ï¼š
- Services/ï¼šTelegramã€Emailã€Oandaã€TradeLockerï¼ˆ4ç±»å¤–éƒ¨æœåŠ¡ï¼‰
- Repositories/ï¼šAzure Table Storageç›‘æ§æ•°æ®
- Models/ï¼šç›‘æ§é…ç½®æ¨¡å‹

**å»ºè®®**ï¼ˆå¦‚æœé¡¹ç›®ç»§ç»­æ‰©å¤§ï¼‰ï¼š
```
â”œâ”€â”€ Trading.Infras.Messaging      - æ¶ˆæ¯é€šçŸ¥ï¼ˆTelegram, Emailï¼‰
â”œâ”€â”€ Trading.Infras.Brokers        - åˆ¸å•†é›†æˆï¼ˆOanda, TradeLockerï¼‰
â””â”€â”€ Trading.Infras.Monitoring     - ç›‘æ§æ•°æ®å­˜å‚¨ï¼ˆAzure Tableï¼‰
```

---

## ğŸ—‘ï¸ æ˜¯å¦éœ€è¦æ¸…ç†ï¼Ÿ

### **ç»“è®ºï¼šä¸éœ€è¦æ¸…ç†ï¼Œä½†å¯ä»¥ä¼˜åŒ–**

#### **ä¸éœ€è¦åˆ é™¤çš„åŸå› ï¼š**
1. âœ… **æ‰€æœ‰é¡¹ç›®éƒ½åœ¨ä½¿ç”¨**
   - Trading.Core: è¢«Strategy.Analyzer, Backtest, Infras.Serviceä¾èµ–
   - Trading.Models: è¢«æ‰€æœ‰é¡¹ç›®ä¾èµ–
   - Trading.Infrastructure: è¢«Infras.Serviceå’ŒInfras.Webä½¿ç”¨

2. âœ… **èŒè´£ä¸é‡å¤**
   - Trading.Models = æ ¸å¿ƒæ•°æ®æ¨¡å‹ + Cosmos DB
   - Trading.Infrastructure = å¤–éƒ¨æœåŠ¡é›†æˆ + Azure Tableç›‘æ§

3. âœ… **æ¶æ„åˆç†**
   - ç¬¦åˆæ´‹è‘±æ¶æ„ï¼šCore â†’ Data â†’ Infrastructure

#### **å¯é€‰çš„ä¼˜åŒ–å»ºè®®ï¼š**

##### **å»ºè®®1ï¼šé‡å‘½å Trading.Infrastructureï¼ˆä½ä¼˜å…ˆçº§ï¼‰**
```bash
# å¦‚æœè§‰å¾—åå­—å®¹æ˜“æ··æ·†
git mv src/Trading.Infrastructure src/Trading.Infras.Integration
# ç„¶åæ›´æ–°æ‰€æœ‰å¼•ç”¨å’Œå‘½åç©ºé—´
```

**å½±å“**ï¼š
- éœ€è¦æ›´æ–°5ä¸ªæ–‡ä»¶çš„é¡¹ç›®å¼•ç”¨
- éœ€è¦æ›´æ–°çº¦50ä¸ªæ–‡ä»¶çš„å‘½åç©ºé—´
- éœ€è¦æ›´æ–°TradingSystem.sln

**æ”¶ç›Š**ï¼š
- å‘½åæ›´æ¸…æ™°ï¼Œå‡å°‘æ–°äººå›°æƒ‘
- æ›´å¥½åœ°è¡¨è¾¾"é›†æˆå¤–éƒ¨æœåŠ¡"çš„èŒè´£

##### **å»ºè®®2ï¼šæ‹†åˆ† Trading.Modelsï¼ˆä»…å½“é¡¹ç›®è§„æ¨¡è¿›ä¸€æ­¥æ‰©å¤§æ—¶ï¼‰**
```
å½“å‰é¡¹ç›®è§„æ¨¡ä¸‹ä¸å»ºè®®æ‹†åˆ†
é™¤éï¼š
- Trading.Modelsè¶…è¿‡50ä¸ªæ–‡ä»¶
- å¤šä¸ªå›¢é˜Ÿå¹¶è¡Œå¼€å‘
- éœ€è¦ç‹¬ç«‹ç‰ˆæœ¬ç®¡ç†
```

---

## ğŸ“‹ ä¾èµ–å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨å±‚ï¼ˆå·²å½’æ¡£ï¼‰                        â”‚
â”‚  Trading.Backtest.*  Trading.Strategy.Analyzer           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åŸºç¡€è®¾æ–½å±‚                              â”‚
â”‚  Trading.Services  Trading.Infras.Web              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Trading.Core â”‚       â”‚Trading.Infrastructureâ”‚
â”‚  (ç­–ç•¥/æŒ‡æ ‡)  â”‚       â”‚(å¤–éƒ¨æœåŠ¡é›†æˆ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Trading.Models   â”‚
        â”‚(æ•°æ®æ¨¡å‹/Cosmos)â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ¨èæ“ä½œ

### **ç«‹å³æ“ä½œï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ï¼šæ— **
å½“å‰ç»“æ„åˆç†ï¼Œä¸éœ€è¦æ¸…ç†ã€‚

### **å¯é€‰ä¼˜åŒ–ï¼ˆä½ä¼˜å…ˆçº§ï¼‰ï¼š**

#### **é€‰é¡¹1ï¼šé‡å‘½åä»¥æé«˜æ¸…æ™°åº¦**
```bash
# 1. é‡å‘½å Trading.Infrastructure â†’ Trading.Infras.Integration
git mv src/Trading.Infrastructure src/Trading.Infras.Integration

# 2. æ›´æ–°æ‰€æœ‰å¼•ç”¨ï¼ˆå¯ç”¨è„šæœ¬æ‰¹é‡å¤„ç†ï¼‰
# - æ›´æ–° .csproj ä¸­çš„ ProjectReference
# - æ›´æ–° .cs æ–‡ä»¶ä¸­çš„ using è¯­å¥
# - æ›´æ–° namespace å£°æ˜
# - æ›´æ–° TradingSystem.sln
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å°æ—¶  
**é£é™©**ï¼šä½ï¼ˆçº¯é‡å‘½åï¼Œä¸æ”¹å˜é€»è¾‘ï¼‰  
**æ”¶ç›Š**ï¼šæå‡ä»£ç å¯è¯»æ€§

#### **é€‰é¡¹2ï¼šä¿æŒç°çŠ¶ï¼ˆæ¨èï¼‰**
å¦‚æœå›¢é˜Ÿå·²ç»ç†Ÿæ‚‰å½“å‰ç»“æ„ï¼Œä¿æŒç°çŠ¶æ›´ç¨³å¦¥ã€‚

---

## ğŸ“ æ€»ç»“

**å›ç­”æ‚¨çš„é—®é¢˜ï¼š**

1. **å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ**
   - Trading.Core: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆç­–ç•¥ã€æŒ‡æ ‡ã€é£é™©ç®¡ç†ï¼‰
   - Trading.Models: æ•°æ®æ¨¡å‹ + Cosmos DBåŸºç¡€è®¾æ–½
   - Trading.Infrastructure: å¤–éƒ¨æœåŠ¡é›†æˆï¼ˆTelegramã€Emailã€Oandaã€Azure Tableï¼‰
   - å®ƒä»¬å„å¸å…¶èŒï¼Œä¾èµ–å…³ç³»æ¸…æ™°

2. **è¦ä¸è¦æ¸…ç†ï¼Ÿ**
   - **ä¸éœ€è¦æ¸…ç†** âœ…
   - æ‰€æœ‰é¡¹ç›®éƒ½åœ¨ä½¿ç”¨ï¼ŒèŒè´£ä¸é‡å¤
   - æ¶æ„åˆç†ï¼Œç¬¦åˆåˆ†å±‚è®¾è®¡åŸåˆ™
   - å¯é€‰ï¼šé‡å‘½å Trading.Infrastructure â†’ Trading.Infras.Integrationï¼ˆæé«˜å¯è¯»æ€§ï¼‰

**æœ€ç»ˆå»ºè®®ï¼šä¿æŒç°çŠ¶ï¼Œä¸“æ³¨ä¸šåŠ¡å¼€å‘**
